{"ast":null,"code":"import _objectSpread from\"/Users/mdearaujo/Downloads/LETZ/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{Container,Paper,Box,TextField,Button,Typography,FormControl,InputLabel,Select,MenuItem,FormControlLabel,Switch,Grid,Alert,CircularProgress,InputAdornment}from'@mui/material';import{DateTimePicker,LocalizationProvider}from'@mui/x-date-pickers';import{AdapterDateFns}from'@mui/x-date-pickers/AdapterDateFns';import{ptBR}from'date-fns/locale';import{Event as EventIcon,LocationOn as LocationIcon,People as PeopleIcon,AttachMoney as MoneyIcon,Save as SaveIcon,BugReport as TestIcon}from'@mui/icons-material';import{useNavigate}from'react-router-dom';import{useAppDispatch,useAppSelector}from'../hooks/redux';import{createEvent}from'../store/slices/eventSlice';import{testEventCreation,testLogin}from'../utils/testEventCreation';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const eventTypes=[{value:'CHURRASCO',label:'Churrasco'},{value:'FESTA',label:'Festa'},{value:'JANTAR',label:'Jantar'},{value:'REUNIAO',label:'Reunião'},{value:'ANIVERSARIO',label:'Aniversário'},{value:'OUTROS',label:'Outros'}];const CreateEventPage=()=>{const navigate=useNavigate();const dispatch=useAppDispatch();const{isLoading,error}=useAppSelector(state=>state.events);const[formData,setFormData]=useState({title:'',description:'',type:'',startDateTime:new Date(),endDateTime:null,location:'',address:'',latitude:null,longitude:null,maxParticipants:'',isPrivate:true,requiresApproval:false,totalCost:'',hasCostSharing:false});const[validationErrors,setValidationErrors]=useState([]);const[testLoading,setTestLoading]=useState(false);const handleChange=field=>value=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));// Limpar erros de validação\nif(validationErrors.length>0){setValidationErrors([]);}};const handleTextFieldChange=e=>{const{name,value}=e.target;handleChange(name)(value);};const validateForm=()=>{const errors=[];if(!formData.title.trim()){errors.push('Título é obrigatório');}if(!formData.type){errors.push('Tipo do evento é obrigatório');}if(!formData.location.trim()){errors.push('Local é obrigatório');}if(formData.startDateTime<=new Date()){errors.push('Data de início deve ser no futuro');}if(formData.endDateTime&&formData.endDateTime<=formData.startDateTime){errors.push('Data de fim deve ser após a data de início');}if(formData.maxParticipants&&parseInt(formData.maxParticipants)<1){errors.push('Número máximo de participantes deve ser maior que 0');}if(formData.totalCost&&parseFloat(formData.totalCost)<0){errors.push('Custo total não pode ser negativo');}return errors;};const handleSubmit=async e=>{e.preventDefault();const errors=validateForm();if(errors.length>0){setValidationErrors(errors);return;}const eventData=_objectSpread(_objectSpread({},formData),{},{startDateTime:formData.startDateTime.toISOString(),endDateTime:formData.endDateTime?formData.endDateTime.toISOString():undefined,maxParticipants:formData.maxParticipants?parseInt(formData.maxParticipants):undefined,totalCost:formData.totalCost?parseFloat(formData.totalCost):undefined,latitude:formData.latitude||undefined,longitude:formData.longitude||undefined});try{const result=await dispatch(createEvent(eventData));if(createEvent.fulfilled.match(result)){navigate('/dashboard');}}catch(error){console.error('Erro ao criar evento:',error);}};const handleTestEvent=async()=>{setTestLoading(true);try{// Primeiro fazer login\nawait testLogin();// Depois criar evento\nawait testEventCreation();alert('Teste realizado com sucesso! Verifique o console para detalhes.');}catch(error){console.error('Erro no teste:',error);alert('Erro no teste. Verifique o console para detalhes.');}finally{setTestLoading(false);}};return/*#__PURE__*/_jsx(Container,{maxWidth:\"md\",sx:{mt:4,mb:4},children:/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:4},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:3},children:[/*#__PURE__*/_jsx(EventIcon,{sx:{mr:2,color:'primary.main'}}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",children:\"Criar Evento\"})]}),/*#__PURE__*/_jsx(Box,{sx:{mb:3},children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",startIcon:testLoading?/*#__PURE__*/_jsx(CircularProgress,{size:20}):/*#__PURE__*/_jsx(TestIcon,{}),onClick:handleTestEvent,disabled:testLoading,children:testLoading?'Testando...':'Teste de Criação de Evento'})}),(error||validationErrors.length>0)&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:3},children:error||validationErrors.map((err,index)=>/*#__PURE__*/_jsx(\"div\",{children:err},index))}),/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,adapterLocale:ptBR,children:/*#__PURE__*/_jsx(Box,{component:\"form\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Informa\\xE7\\xF5es B\\xE1sicas\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:8,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,required:true,name:\"title\",label:\"T\\xEDtulo do Evento\",value:formData.title,onChange:handleTextFieldChange,disabled:isLoading,placeholder:\"Ex: Churrasco de fim de semana\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Tipo de Evento\"}),/*#__PURE__*/_jsx(Select,{value:formData.type,label:\"Tipo de Evento\",onChange:e=>handleChange('type')(e.target.value),disabled:isLoading,children:eventTypes.map(type=>/*#__PURE__*/_jsx(MenuItem,{value:type.value,children:type.label},type.value))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,rows:3,name:\"description\",label:\"Descri\\xE7\\xE3o\",value:formData.description,onChange:handleTextFieldChange,disabled:isLoading,placeholder:\"Descreva seu evento...\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Data e Hora\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(DateTimePicker,{label:\"Data e Hora de In\\xEDcio\",value:formData.startDateTime,onChange:handleChange('startDateTime'),disabled:isLoading,slotProps:{textField:{fullWidth:true,required:true}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(DateTimePicker,{label:\"Data e Hora de Fim (opcional)\",value:formData.endDateTime,onChange:handleChange('endDateTime'),disabled:isLoading,slotProps:{textField:{fullWidth:true}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Localiza\\xE7\\xE3o\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,required:true,name:\"location\",label:\"Local\",value:formData.location,onChange:handleTextFieldChange,disabled:isLoading,placeholder:\"Ex: Casa do Jo\\xE3o\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(LocationIcon,{})})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,name:\"address\",label:\"Endere\\xE7o Completo\",value:formData.address,onChange:handleTextFieldChange,disabled:isLoading,placeholder:\"Rua, n\\xFAmero, bairro, cidade\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Configura\\xE7\\xF5es\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,name:\"maxParticipants\",label:\"M\\xE1ximo de Participantes\",type:\"number\",value:formData.maxParticipants,onChange:handleTextFieldChange,disabled:isLoading,placeholder:\"Deixe vazio para ilimitado\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(PeopleIcon,{})})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,name:\"totalCost\",label:\"Custo Estimado (R$)\",type:\"number\",value:formData.totalCost,onChange:handleTextFieldChange,disabled:isLoading,inputProps:{step:\"0.01\"},InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(MoneyIcon,{})})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:formData.isPrivate,onChange:e=>handleChange('isPrivate')(e.target.checked),disabled:isLoading}),label:\"Evento Privado (apenas convidados)\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:formData.requiresApproval,onChange:e=>handleChange('requiresApproval')(e.target.checked),disabled:isLoading}),label:\"Requer aprova\\xE7\\xE3o para participar\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:formData.hasCostSharing,onChange:e=>handleChange('hasCostSharing')(e.target.checked),disabled:isLoading}),label:\"Dividir custos entre participantes\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>navigate('/dashboard'),disabled:isLoading,children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",startIcon:isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:20}):/*#__PURE__*/_jsx(SaveIcon,{}),disabled:isLoading,children:isLoading?'Criando...':'Criar Evento'})]})})]})})})]})});};export default CreateEventPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}