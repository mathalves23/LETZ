{"ast":null,"code":"import _objectSpread from\"/Users/mdearaujo/Downloads/LETZ/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/Users/mdearaujo/Downloads/LETZ/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"children\",\"value\",\"index\"];import React,{useState,useEffect}from'react';import{Box,Container,Typography,Paper,Tabs,Tab,List,ListItem,ListItemText,ListItemAvatar,ListItemSecondaryAction,Avatar,Button,TextField,InputAdornment,IconButton,Chip,Alert,CircularProgress,Dialog,DialogTitle,DialogContent,DialogActions}from'@mui/material';import{Search as SearchIcon,PersonAdd as PersonAddIcon,Check as CheckIcon,Close as CloseIcon,Person as PersonIcon,Message as MessageIcon}from'@mui/icons-material';import{useAppDispatch,useAppSelector}from'../hooks/redux';import{sendFriendRequest,acceptFriendRequest,rejectFriendRequest,fetchFriends,fetchPendingRequests}from'../store/slices/friendshipSlice';import{userAPI}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function TabPanel(props){const{children,value,index}=props,other=_objectWithoutProperties(props,_excluded);return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({role:\"tabpanel\",hidden:value!==index,id:\"friends-tabpanel-\".concat(index),\"aria-labelledby\":\"friends-tab-\".concat(index)},other),{},{children:value===index&&/*#__PURE__*/_jsx(Box,{sx:{py:3},children:children})}));}function FriendsPage(){const dispatch=useAppDispatch();const{friends=[],pendingRequests=[],sentRequests=[],isLoading,error}=useAppSelector(state=>state.friendships);const[tabValue,setTabValue]=useState(0);const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[isSearching,setIsSearching]=useState(false);const[confirmDialog,setConfirmDialog]=useState({open:false,action:'accept'});useEffect(()=>{dispatch(fetchFriends());dispatch(fetchPendingRequests());},[dispatch]);const handleTabChange=(event,newValue)=>{setTabValue(newValue);};const handleSearch=async()=>{if(searchQuery.trim()){setIsSearching(true);try{const response=await userAPI.searchUsers(searchQuery);setSearchResults(response.data);}catch(error){console.error('Erro ao buscar usuários:',error);setSearchResults([]);}finally{setIsSearching(false);}}};const handleSearchKeyPress=event=>{if(event.key==='Enter'){handleSearch();}};const handleSendFriendRequest=userId=>{dispatch(sendFriendRequest(userId));};const handleRespondToRequest=(friendshipId,accept)=>{if(accept){dispatch(acceptFriendRequest(friendshipId));}else{dispatch(rejectFriendRequest(friendshipId));}setConfirmDialog({open:false,action:'accept'});};const openConfirmDialog=(action,friendshipId,userName)=>{setConfirmDialog({open:true,action,friendshipId,userName});};const closeConfirmDialog=()=>{setConfirmDialog({open:false,action:'accept'});};const getStatusColor=status=>{switch(status){case'ACCEPTED':return'success';case'PENDING':return'warning';case'REJECTED':return'error';default:return'default';}};const getFullName=(firstName,lastName)=>{return\"\".concat(firstName,\" \").concat(lastName).trim();};const renderSearchResults=()=>/*#__PURE__*/_jsxs(List,{children:[searchResults.map(user=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:/*#__PURE__*/_jsx(PersonIcon,{})})}),/*#__PURE__*/_jsx(ListItemText,{primary:getFullName(user.firstName,user.lastName),secondary:\"\".concat(user.email,\" \\u2022 @\").concat(user.username)}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(PersonAddIcon,{}),onClick:()=>handleSendFriendRequest(user.id),disabled:isLoading,children:\"Adicionar\"})})]},user.id)),searchResults.length===0&&searchQuery&&!isSearching&&/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Nenhum usu\\xE1rio encontrado\",secondary:\"Tente buscar por outro nome ou email\"})})]});const renderFriends=()=>/*#__PURE__*/_jsxs(List,{children:[friends.map(friend=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:/*#__PURE__*/_jsx(PersonIcon,{})})}),/*#__PURE__*/_jsx(ListItemText,{primary:getFullName(friend.firstName,friend.lastName),secondary:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:friend.email}),/*#__PURE__*/_jsx(Chip,{label:friend.isOnline?'Online':'Offline',size:\"small\",color:friend.isOnline?'success':'default',variant:\"outlined\"})]})}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",size:\"small\",children:/*#__PURE__*/_jsx(MessageIcon,{})})})]},friend.id)),friends.length===0&&/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Nenhum amigo ainda\",secondary:\"Que tal buscar por alguns amigos?\"})})]});const renderPendingRequests=()=>/*#__PURE__*/_jsxs(List,{children:[pendingRequests.map(request=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:/*#__PURE__*/_jsx(PersonIcon,{})})}),/*#__PURE__*/_jsx(ListItemText,{primary:getFullName(request.requester.firstName,request.requester.lastName),secondary:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:request.requester.email}),/*#__PURE__*/_jsx(Chip,{label:request.status,size:\"small\",color:getStatusColor(request.status),variant:\"outlined\"})]})}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(IconButton,{color:\"success\",size:\"small\",onClick:()=>openConfirmDialog('accept',request.id,getFullName(request.requester.firstName,request.requester.lastName)),children:/*#__PURE__*/_jsx(CheckIcon,{})}),/*#__PURE__*/_jsx(IconButton,{color:\"error\",size:\"small\",onClick:()=>openConfirmDialog('reject',request.id,getFullName(request.requester.firstName,request.requester.lastName)),children:/*#__PURE__*/_jsx(CloseIcon,{})})]})})]},request.id)),pendingRequests.length===0&&/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Nenhuma solicita\\xE7\\xE3o pendente\",secondary:\"Voc\\xEA est\\xE1 em dia com suas solicita\\xE7\\xF5es de amizade!\"})})]});return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,sx:{mb:4},children:\"\\uD83D\\uDC65 Amigos\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:3},children:error}),/*#__PURE__*/_jsxs(Paper,{elevation:3,children:[/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Tabs,{value:tabValue,onChange:handleTabChange,\"aria-label\":\"friends tabs\",children:[/*#__PURE__*/_jsx(Tab,{label:\"Buscar Amigos\"}),/*#__PURE__*/_jsx(Tab,{label:\"Meus Amigos (\".concat(friends.length,\")\")}),/*#__PURE__*/_jsx(Tab,{label:\"Solicita\\xE7\\xF5es (\".concat(pendingRequests.length,\")\")})]})}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:0,children:[/*#__PURE__*/_jsx(Box,{sx:{mb:3},children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,placeholder:\"Buscar amigos por nome ou email...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),onKeyPress:handleSearchKeyPress,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(SearchIcon,{})}),endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSearch,disabled:isSearching||!searchQuery.trim(),children:isSearching?/*#__PURE__*/_jsx(CircularProgress,{size:20}):'Buscar'})})}})}),renderSearchResults()]}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:1,children:renderFriends()}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:2,children:renderPendingRequests()})]}),/*#__PURE__*/_jsxs(Dialog,{open:confirmDialog.open,onClose:closeConfirmDialog,children:[/*#__PURE__*/_jsx(DialogTitle,{children:confirmDialog.action==='accept'?'Aceitar Solicitação':'Rejeitar Solicitação'}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(Typography,{children:confirmDialog.action==='accept'?\"Deseja aceitar a solicita\\xE7\\xE3o de amizade de \".concat(confirmDialog.userName,\"?\"):\"Deseja rejeitar a solicita\\xE7\\xE3o de amizade de \".concat(confirmDialog.userName,\"?\")})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:closeConfirmDialog,children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleRespondToRequest(confirmDialog.friendshipId,confirmDialog.action==='accept'),color:confirmDialog.action==='accept'?'success':'error',variant:\"contained\",children:confirmDialog.action==='accept'?'Aceitar':'Rejeitar'})]})]})]});}export default FriendsPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}